<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pernod Ricard - Framework Data Quality avec dbt</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #632ff5 0%, #ff6803 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #632ff5 0%, #ff6803 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .tabs {
            display: flex;
            border-bottom: 3px solid #e0e0e0;
            background: #f5f5f5;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 0.95em;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-bottom: -3px;
            min-width: 150px;
        }
        
        .tab-btn:hover {
            background: #efefef;
            color: #ff6803;
        }
        
        .tab-btn.active {
            color: #632ff5;
            border-bottom-color: #632ff5;
            background: white;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            font-size: 1.5em;
            color: #333;
            margin: 25px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #ff6803;
        }
        
        .stage-box {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            background: #fafafa;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }
        
        .stage-box:hover {
            border-color: #632ff5;
            box-shadow: 0 5px 15px rgba(99, 47, 245, 0.2);
            transform: translateY(-3px);
        }
        
        .stage-box h3 {
            color: #632ff5;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stage-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #632ff5 0%, #ff6803 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .issue-box {
            background: #fff3cd;
            border-left: 4px solid #ff6b6b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .benefit-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .process-flow {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .flow-item {
            background: #f0f0f0;
            padding: 15px 20px;
            border-radius: 6px;
            border: 2px solid #632ff5;
            font-weight: 600;
            text-align: center;
        }
        
        .flow-arrow {
            font-size: 1.5em;
            color: #ff6803;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.95em;
        }
        
        .comparison-table thead {
            background: #f5f5f5;
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .comparison-table th {
            font-weight: 600;
            color: #632ff5;
        }
        
        .comparison-table tr:hover {
            background: #f9f9f9;
        }
        
        .current {
            background: #ffe6e6;
        }
        
        .future {
            background: #e6f2ff;
        }
        
        .tools-list {
            list-style: none;
            margin: 12px 0;
        }
        
        .tools-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .tools-list li:before {
            content: "‚Üí ";
            color: #632ff5;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            .tab-btn {
                min-width: 120px;
                padding: 12px;
                font-size: 0.85em;
            }
        }
        
        .stakeholder-card {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #ff6803;
            margin-bottom: 10px;
        }
        
        .stakeholder-card strong {
            color: #632ff5;
            display: block;
            margin-bottom: 5px;
        }
        
        .footer {
            background: #f5f5f5;
            color: #666;
            text-align: center;
            padding: 20px;
            border-top: 1px solid #ddd;
            font-size: 0.9em;
        }

        a {
            color: #632ff5;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
            color: #ff6803;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üç∑ Pernod Ricard - Framework Data Quality</h1>
            <p>Gouvernance de la qualit√© des donn√©es avec dbt | Plateforme Codex</p>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('current-state')">√âtat Actuel</button>
            <button class="tab-btn" onclick="switchTab('challenges')">Enjeux</button>
            <button class="tab-btn" onclick="switchTab('dbt-solution')">Solution dbt</button>
            <button class="tab-btn" onclick="switchTab('new-process')">Nouveau Processus</button>
            <button class="tab-btn" onclick="switchTab('governance')">Gouvernance</button>
            <button class="tab-btn" onclick="switchTab('implementation')">Roadmap</button>
        </div>

        <!-- TAB 1: CURRENT STATE -->
        <div id="current-state" class="tab-content active">
            <h2 class="section-title">√âtat Actuel chez Pernod Ricard</h2>
            
            <div class="stage-box">
                <h3><span class="stage-icon">1</span> Infrastructure Technique</h3>
                <ul class="tools-list">
                    <li><strong>Data Warehouse:</strong> Snowflake (plateforme centralis√©e, ~7 mois)</li>
                    <li><strong>Cloud Provider:</strong> Azure</li>
                    <li><strong>Transformation:</strong> dbt Core (actuellement) + migration vers dbt Cloud (Enterprise) pr√©vue</li>
                    <li><strong>BI & Restitution:</strong> Tableau & Power BI (connexion directe aux mod√®les dbt via plug-and-play natif)</li>
                    <li><strong>Data Catalog:</strong> Codex (interne + int√©gration dbt Catalog)</li>
                    <li><strong>Architecture Donn√©es:</strong> M√©daillon (Bronze/Silver/Gold) - Landing ‚Üí Staging ‚Üí Mart</li>
                    <li><strong>Projet LIP (critique):</strong> Globalisation donn√©es - unifier CRM, GDE, ERP et autres syst√®mes</li>
                </ul>
            </div>

            <div class="stage-box">
                <h3><span class="stage-icon">2</span> Organisation Actuelle</h3>
                <p><strong>Data Platform Squad:</strong> Fournit les enablers pour un delivery plus rapide</p>
                <p><strong>Domain-based squads:</strong> ~10 √©quipes par domaine (supply chain, marketing, sales, etc.)</p>
                <p><strong>Chapters:</strong> Groupes transversaux (Archi, Data Arch) qui d√©finissent les guidelines</p>
            </div>

            <div class="stage-box">
                <h3><span class="stage-icon">3</span> √âtat Actuel de la Qualit√© de Donn√©es</h3>
                <p style="margin-bottom: 10px;"><strong>√âtat:</strong> Fragmentation totale ‚ùå</p>
                <ul class="tools-list">
                    <li>Initiatives silot√©es par √©quipe - aucune solution globale</li>
                    <li>Mix disparate: scripts ad-hoc, proc√©dures stock√©es, processus dbt isol√©s</li>
                    <li>Quelques √©quipes font du profiling/monitoring technique uniquement</li>
                    <li>Aucun framework ou guideline appliqu√©</li>
                    <li>Pas d'outils user-friendly pour le m√©tier</li>
                    <li>Responsabilit√©s √©parpill√©es entre ingestion, transformation, data stewards</li>
                </ul>
            </div>

            <div class="issue-box">
                <strong>‚ùå Cons√©quence:</strong> Le m√©tier rejette la responsabilit√© de la qualit√© car pas d'outil accessible. Les √©quipes techniques font du minimum (v√©rification technique, pas de r√®gles m√©tier).
            </div>

            <div class="stage-box">
                <h3><span class="stage-icon">4</span> Projet LIP: Catalyseur pour la Data Quality</h3>
                <p><strong>üöÄ Projet de Globalisation Crit√®re:</strong></p>
                <ul class="tools-list">
                    <li>Unifier tous les CRM, ERP, GDE et syst√®mes m√©tier dispers√©s</li>
                    <li>Consolider les donn√©es d'acquisitions multiples en un syst√®me coh√©rent</li>
                    <li>IMPACT: √ânorme volume de donn√©es en migration</li>
                    <li><strong>D√©pendance critique:</strong> La qualit√© de la migration d√©pend de la qualit√© des contr√¥les</li>
                    <li>Window strat√©gique: C'est le moment d'impl√©menter une gouvernance de qualit√© AVANT la migration</li>
                </ul>
                <p style="margin-top: 15px;"><strong>Connexion √† Data Quality:</strong> Si on ne standardise pas la qualit√© maintenant, le projet LIP va propager les m√™mes probl√®mes √† l'√©chelle de toute l'organisation.</p>
            </div>
        </div>

        <!-- TAB 2: CHALLENGES -->
        <div id="challenges" class="tab-content">
            <h2 class="section-title">Enjeux Identifi√©s</h2>

            <div class="stage-box">
                <h3><span class="stage-icon">1</span> Contexte: Acquisitions Multiples</h3>
                <p>Pernod Ricard s'est construit par acquisitions successives ‚Üí chaque marque/acquisition a ses propres processus, syst√®mes, et donn√©es disparates.</p>
                <p style="margin-top: 10px;"><strong>R√©sultat:</strong> Donn√©es tr√®s h√©t√©rog√®nes, no common language, confusion au reporting et difficult√©s de consolidation.</p>
                <p style="margin-top: 10px;"><strong>Probl√®me aggrav√© par:</strong> Absence d'harmonisation des d√©finitions m√©tier entre entit√©s (ex: m√™me "revenu" ne signifie pas la m√™me chose partout)</p>
            </div>

            <div class="stage-box">
                <h3><span class="stage-icon">2</span> Pourquoi Agir Maintenant? (Timing Strat√©gique)</h3>
                <p><strong>Window d'opportunit√© critique:</strong></p>
                <ul class="tools-list">
                    <li><strong>Plateforme jeune (7 mois):</strong> Codex n'est pas encore ossifi√©e ‚Üí excellent timing pour standardiser d√®s le d√©part</li>
                    <li><strong>√âquipes en construction (< 1 an):</strong> Squads m√©tier naissent - absorber bonnes pratiques d√®s la gen√®se</li>
                    <li><strong>Projet LIP imminent:</strong> Grande migration de donn√©es = moment critique pour valider la qualit√© AVANT migration</li>
                    <li><strong>√âviter la reproduction:</strong> Ne pas perp√©tuer les probl√®mes du pass√© (silotage, disparate tooling) dans la nouvelle plateforme</li>
                </ul>
            </div>

            <div class="stage-box">
                <h3><span class="stage-icon">3</span> 4 Grands Besoins de Data Quality</h3>
                <p><strong>üîç Profiling:</strong> Comprendre avec quelles donn√©es on travaille (structure, contenu, distributions)</p>
                <p style="margin-top: 10px;"><strong>üìä Observation:</strong> Suivre l'√©volution de la donn√©e √† travers SON CYCLE DE VIE complet</p>
                <ul style="margin-left: 40px; margin-top: 5px;">
                    <li>Depuis l'ingestion (source systems)</li>
                    <li>√Ä travers les transformations (staging ‚Üí mart)</li>
                    <li>Jusqu'√† l'archivage ou suppression</li>
                    <li>Sur diff√©rents niveaux (row-level, column-level, aggregate)</li>
                </ul>
                <p style="margin-top: 10px;"><strong>üö® Monitoring & Alerting:</strong> D√©tecter et anticiper les probl√®mes</p>
                <ul style="margin-left: 40px; margin-top: 5px;">
                    <li>Identifier rapidement les anomalies</li>
                    <li>Pr√©venir en amont les impacts downstream (dashboards, rapports)</li>
                    <li>Alerter les responsables imm√©diatement</li>
                </ul>
                <p style="margin-top: 10px;"><strong>üìà Indice de Confiance:</strong> Fournir un score de qualit√© aux utilisateurs finaux</p>
                <ul style="margin-left: 40px; margin-top: 5px;">
                    <li>M√©trique consolid√©e de sant√© de la donn√©e</li>
                    <li>Transparent dans dbt Catalog/Exposures</li>
                    <li>Communiquer trust vs. risk aux m√©tiers</li>
                </ul>
            </div>

            <div class="issue-box">
                <strong>üéØ Besoin Additionnel:</strong> Un <strong>score de qualit√© / indice de confiance</strong> pour montrer aux utilisateurs que leur donn√©e est fiable.
            </div>

            <h3 style="margin-top: 30px; color: #632ff5;">Deux Aspects Importants:</h3>
            
            <div style="margin-top: 15px;">
                <p><strong>1Ô∏è‚É£ Data Quality (volet technique):</strong></p>
                <p style="margin-left: 20px;">V√©rifier que la donn√©e respecte les r√®gles m√©tier (ex: date_d√©part > date_arriv√©e, pas de valeurs impossibles)</p>
                <p style="margin-left: 20px;">Bloquant pour pipeline si probl√®me ‚Üí pr√©vention d'erreurs en production</p>
            </div>

            <div style="margin-top: 15px;">
                <p><strong>2Ô∏è‚É£ Data Governance (volet organisation):</strong></p>
                <p style="margin-left: 20px;">Harmonisation des m√©triques (m√™me d√©finition de "revenu" finance vs marketing)</p>
                <p style="margin-left: 20px;">‚Ü≥ Ceci est confi√© √† l'√©quipe Data Governance (pas data quality)</p>
            </div>
        </div>

        <!-- TAB 3: DBT SOLUTION -->
        <div id="dbt-solution" class="tab-content">
            <h2 class="section-title">Comment dbt R√©pond aux Enjeux</h2>

            <div style="background: #f0f0f0; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
                <h3 style="color: #632ff5; margin-bottom: 15px;">üéØ 3 Capabilities Majeures</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #632ff5;">
                        <strong>1. Quality Assurance</strong>
                        <p style="margin-top: 8px; font-size: 0.9em; color: #666;">Framework standardis√© de testing √† chaque √©tape du pipeline</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #ff6803;">
                        <strong>2. Development Velocity</strong>
                        <p style="margin-top: 8px; font-size: 0.9em; color: #666;">Copilot IA + Cloud platform pour d√©veloppement rapide et s√ªr</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #28a745;">
                        <strong>3. Data Trust</strong>
                        <p style="margin-top: 8px; font-size: 0.9em; color: #666;">Monitoring continu + observabilit√© compl√®te + catalogue unique</p>
                    </div>
                </div>
            </div>

            <!-- SECTION 1: TESTING & QUALITY -->
            <h3 style="margin-top: 30px; color: #632ff5; font-size: 1.3em; border-bottom: 3px solid #ff6803; padding-bottom: 10px;">
                üìä Section 1: Testing & Quality Framework
            </h3>

            <div class="stage-box">
                <h4><span class="stage-icon">1.1</span> Framework de Testing Standardis√©</h4>
                <p><strong>dbt offre un framework coh√©rent pour tester √† chaque √©tape:</strong></p>
                <ul class="tools-list">
                    <li><strong>Generic Tests (YAML):</strong> unique, not_null, relationships, accepted_values ‚Üí simples et r√©utilisables</li>
                    <li><strong>Custom Data Tests:</strong> R√®gles m√©tier complexes en SQL (ex: v√©rifier coh√©rence entre colonnes)</li>
                    <li><strong>Source Freshness:</strong> Monitorer que donn√©es arrivent √† temps (SLA sources)</li>
                    <li><strong>Unit Tests:</strong> Valider la logique des transformations avant de toucher la prod</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">1.2</span> dbt Copilot - G√©n√©ration Intelligente (80/20 Rule)</h4>
                <p><strong>Probl√®me:</strong> √âcrire des tests c'est long, r√©p√©titif, et on oublie toujours quelque chose</p>
                <p style="margin-top: 10px;"><strong>Solution: IA-powered test generation</strong></p>
                <ul class="tools-list">
                    <li>‚ú® <strong>Analyse automatique:</strong> Copilot lit le code SQL + m√©tadonn√©es dbt</li>
                    <li>üöÄ <strong>G√©n√®re 80% des tests:</strong> unique, not_null, relationships, accepted_values en YAML</li>
                    <li>üéØ <strong>20% tuning m√©tier:</strong> Data engineer ajoute r√®gles complexes (seuils, validations sp√©cifiques)</li>
                    <li>‚úÖ <strong>Z√©ro exposition donn√©es:</strong> Metadata only - conforme RGPD/s√©curit√©</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">1.3</span> Quality Scoring - Diff√©rencier Gravit√© des Erreurs</h4>
                <p><strong>Probl√®me:</strong> Tous les tests ne se valent pas - faut-il bloquer la production ou juste alerter?</p>
                <div style="margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background: #fff3cd; padding: 12px; border-radius: 6px; border-left: 4px solid #ff6803;">
                        <strong>‚ö†Ô∏è WARNING</strong>
                        <ul style="margin-left: 20px; margin-top: 8px; font-size: 0.9em;">
                            <li>D√©gradation mineure</li>
                            <li>Nouvelles valeurs accept√©es</li>
                            <li>Data less fresh</li>
                            <li>‚Üí Alerter, pas bloquer</li>
                        </ul>
                    </div>
                    <div style="background: #f8d7da; padding: 12px; border-radius: 6px; border-left: 4px solid #dc3545;">
                        <strong>üî¥ ERROR</strong>
                        <ul style="margin-left: 20px; margin-top: 8px; font-size: 0.9em;">
                            <li>Int√©grit√© critique</li>
                            <li>Cl√© primaire NULL</li>
                            <li>Duplicates inattendus</li>
                            <li>‚Üí Bloquer le d√©ploiement</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- SECTION 2: DEVELOPMENT & DEPLOYMENT -->
            <h3 style="margin-top: 30px; color: #632ff5; font-size: 1.3em; border-bottom: 3px solid #ff6803; padding-bottom: 10px;">
                ‚öôÔ∏è Section 2: Development & Deployment Process
            </h3>

            <div class="stage-box">
                <h4><span class="stage-icon">2.1</span> dbt Cloud - D√©veloppement sans Installation Locale</h4>
                <p><strong>B√©n√©fice:</strong> Pas de complexit√© Git/terminal pour les non-techies</p>
                <ul class="tools-list">
                    <li><strong>Web IDE:</strong> Coder directement depuis le navigateur (Git int√©gr√©)</li>
                    <li><strong>Branching facile:</strong> Cr√©er branches visuellement sans commandes terminal</li>
                    <li><strong>VS Code Extension:</strong> Pour les power users (CLI avanc√©, git advanced)</li>
                    <li><strong>Collaboratif:</strong> Peer review int√©gr√©, contr√¥le d'acc√®s granulaire</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">2.2</span> CI/CD Automatique & Validation</h4>
                <p><strong>√Ä chaque PR: tout ce qui pourrait casser est test√© AVANT production</strong></p>
                <ul class="tools-list">
                    <li><strong>dbt Cloud Job:</strong> Ex√©cute mod√®les modifi√©s + tous les tests associ√©s en PR</li>
                    <li><strong>Bloquer les merges dangereuses:</strong> Pas de merge si tests fail</li>
                    <li><strong>Intelligent Execution:</strong> R√©utilise r√©sultats de tests si code/data inchang√© (optimisation)</li>
                    <li><strong>Impact preview:</strong> Voir exactement quels dashboards/rapports seront affect√©s par ce changement</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">2.3</span> Analytics Engineering Discipline</h4>
                <p><strong>Concept:</strong> Appliquer Software Engineering best practices √† la donn√©e</p>
                <table class="comparison-table">
                    <tr>
                        <td style="font-weight: bold;">Code Review</td>
                        <td>Tous les changements doivent passer peer review avant prod</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">Version Control</td>
                        <td>Git trace historique complet des transformations (blame, diff, rollback)</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">Testing</td>
                        <td>Data tests = unit tests pour la donn√©e (test coverage > 80%)</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">Documentation</td>
                        <td>Chaque model/colonne document√©e (metadata layer)</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">Monitoring</td>
                        <td>Alerter si donn√©es changent en prod (continuous validation)</td>
                    </tr>
                </table>
                <p style="margin-top: 12px; font-style: italic; color: #666;">‚Üí R√©sultat: Plus confiance, moins incidents, plus v√©locit√© d√©ploiement</p>
            </div>

            <!-- SECTION 3: MONITORING & OBSERVABILITY -->
            <h3 style="margin-top: 30px; color: #632ff5; font-size: 1.3em; border-bottom: 3px solid #ff6803; padding-bottom: 10px;">
                üëÅÔ∏è Section 3: Monitoring & Observability
            </h3>

            <div class="stage-box">
                <h4><span class="stage-icon">3.1</span> Orchestration Intelligente & Optimis√©e</h4>
                <p><strong>Probl√®me actuel:</strong> R√©ex√©cuter 100% des tests chaque nuit = perte massive de temps/ressources</p>
                <ul class="tools-list">
                    <li><strong>Smart execution:</strong> dbt Cloud d√©tecte si code ou data a chang√© depuis dernier run</li>
                    <li><strong>Reuse test results:</strong> Si test a pass√© et rien n'a chang√© ‚Üí r√©utilise r√©sultat (no re-run)</li>
                    <li><strong>Selective building:</strong> Construire uniquement mod√®les affect√©s par les changements</li>
                    <li><strong>Scheduler int√©gr√©:</strong> Configurer quand tests tournent (ex: 22h chaque soir apr√®s ingestion)</li>
                    <li><strong>No external orchestration needed:</strong> Plus besoin Airflow/Dagster juste pour scheduler</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">3.2</span> Alerting Multi-Canal & Proactif</h4>
                <ul class="tools-list">
                    <li><strong>Slack:</strong> Notification imm√©diate si test fail (avec context)</li>
                    <li><strong>Email:</strong> R√©sum√© quotidien/hebdo pour les stakeholders</li>
                    <li><strong>Dashboard m√©tier:</strong> Badge de qualit√© visible directement dans Power BI/Tableau (data freshness)</li>
                    <li><strong>Smart routing:</strong> Alerter la bonne personne (data owner, pas juste engineers)</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">3.3</span> Observabilit√© Compl√®te - Lineage & DAG</h4>
                <p><strong>Visualiser le graphe complet:</strong> Source ‚Üí Ingestion ‚Üí Staging ‚Üí Mart ‚Üí BI Dashboard</p>
                <ul class="tools-list">
                    <li><strong>Lineage bidirectionnel:</strong> Upstream (d√©pendances) et downstream (ce qui en d√©pend)</li>
                    <li><strong>Impact analysis:</strong> Si probl√®me d√©tect√© ici, quels dashboards/rapports seront affect√©s?</li>
                    <li><strong>Run history:</strong> Voir quand chaque mod√®le/test a tourn√©, status (success/fail/error)</li>
                    <li><strong>Query usage:</strong> Identifier mod√®les qui ne sont jamais utilis√©s (candidates suppression)</li>
                    <li><strong>M√©tier-friendly view:</strong> Filtrer par project, voir seulement source‚Üíexposition (abstraire complexit√©)</li>
                </ul>
            </div>

            <!-- SECTION 4: DATA GOVERNANCE & SCALABILITY -->
            <h3 style="margin-top: 30px; color: #632ff5; font-size: 1.3em; border-bottom: 3px solid #ff6803; padding-bottom: 10px;">
                üîê Section 4: Governance & Scalability
            </h3>

            <div class="stage-box">
                <h4><span class="stage-icon">4.1</span> Data Mesh Architecture - Multi-Projet & Autonomie</h4>
                <p><strong>Pattern:</strong> Plusieurs projets dbt autonomes par domaine m√©tier</p>
                <ul class="tools-list">
                    <li><strong>Autonomous squads:</strong> Chaque domaine (CRM, Sales, Supply, etc.) = 1 projet dbt</li>
                    <li><strong>Cross-domain dependencies:</strong> Projet A peut consommer tables de Projet B (read-only access)</li>
                    <li><strong>Schema isolation:</strong> Chaque projet ‚Üí sch√©ma Snowflake d√©di√© (gouvernance par sch√©ma)</li>
                    <li><strong>Role-based access:</strong> Contr√¥ler qui a droit √† quel projet/sch√©ma (via AD/LDAP)</li>
                    <li><strong>Platform-agnostic:</strong> dbt marche sur Snowflake, Databricks, BigQuery, DuckDB ‚Üí no vendor lock-in</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">4.2</span> dbt Catalog - Centre Unique de M√©tadonn√©es</h4>
                <p><strong>Une source de v√©rit√© pour toutes les m√©tadonn√©es donn√©es:</strong></p>
                <ul class="tools-list">
                    <li><strong>Dictionnaire donn√©es:</strong> Chaque colonne ‚Üí description, owner, tests associ√©s, derniers r√©sultats</li>
                    <li><strong>Historique complet:</strong> Tous les tests pass√©s/√©chou√©s sur 30 jours (identifier patterns)</li>
                    <li><strong>Documentation intelligente:</strong> Pourquoi cette transformation? Quelle r√®gle m√©tier?</li>
                    <li><strong>Acc√®s non-technique:</strong> M√©tier peut explorer sans acc√®s SQL ou Snowflake</li>
                    <li><strong>Tags & classifications:</strong> Marquer donn√©es sensibles (PII), critiques business, compliantes</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4><span class="stage-icon">4.3</span> BI Integration - Connexion Transparente & Badges de Qualit√©</h4>
                <p><strong>Tableau & Power BI:</strong> Connexion plug-and-play native aux mod√®les dbt</p>
                <ul class="tools-list">
                    <li><strong>Direct lineage:</strong> Voir dans BI exactement quels mod√®les/sources alimentent ce champ</li>
                    <li><strong>Quality badges:</strong> Afficher directement dans dashboard ‚Üí test status + data freshness</li>
                    <li><strong>One-click root cause:</strong> Cliquer "test failed" ‚Üí aller directement √† dbt Cloud pour investiguer</li>
                    <li><strong>Semantic Layer:</strong> Centraliser d√©finitions m√©tier (Revenue, Customer, Order = unique definition globale)</li>
                </ul>
            </div>

            <div class="benefit-box" style="margin-top: 20px;">
                <strong>‚úÖ Synth√®se:</strong> dbt cr√©e une boucle vertueuse: tests automatiques ‚Üí monitoring continu ‚Üí confiance m√©tier ‚Üí adoption. Tout est int√©gr√© dans le code, versionn√©, document√©, et observable.
            </div>
        </div>

        <!-- TAB 4: NEW PROCESS -->
        <div id="new-process" class="tab-content">
            <h2 class="section-title">Nouveau Processus avec dbt</h2>

            <h3 style="margin-top: 20px; color: #333;">Flow End-to-End avec Responsabilit√©s</h3>
            <div style="margin-bottom: 20px;">
                <div class="flow-item" style="margin-bottom: 10px;">1Ô∏è‚É£ Besoin M√©tier Exprim√©</div>
                <div style="margin-left: 40px; margin-bottom: 15px;"><strong>Par:</strong> Data Product Owners ‚Üí Articulent nouveaux data products, features m√©tier</div>

                <div class="flow-item" style="margin-bottom: 10px;">2Ô∏è‚É£ Data Engineers D√©veloppent Mod√®les</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí Cr√©ent nouvelles tables, models dbt, transformations</div>
                <div style="margin-left: 40px; margin-bottom: 15px;">‚Üí Documentent le mod√®le et les colonnes dans dbt</div>

                <div class="flow-item" style="margin-bottom: 10px;">3Ô∏è‚É£ Gouvernance + Data Owners D√©finissent les R√®gles</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí Collaboration: data producer + data governance + data stewards</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí Discuter les r√®gles de qualit√© m√©tier</div>
                <div style="margin-left: 40px; margin-bottom: 15px;">‚Üí Quels tests? Accept√©_values? Relationships? Rules m√©tier sp√©cifiques?</div>

                <div class="flow-item" style="margin-bottom: 10px;">4Ô∏è‚É£ Data Engineers Impl√©mentent Tests (dbt)</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí Ajouter tests √† YAML (ou utiliser Copilot pour g√©n√©rer)</div>
                <div style="margin-left: 40px; margin-bottom: 15px;">‚Üí Tests tournent √† chaque run, CI/CD valide PRs avant prod</div>

                <div class="flow-item" style="margin-bottom: 10px;">5Ô∏è‚É£ Monitoring Continu + Alerting</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí dbt ex√©cute tests r√©guli√®rement (ex: chaque nuit apr√®s refresh)</div>
                <div style="margin-left: 40px; margin-bottom: 15px;">‚Üí Si test fail: <strong>alerter DATA PRODUCT OWNERS + DATA OWNERS</strong> (pas juste engineers)</div>

                <div class="flow-item" style="margin-bottom: 10px;">6Ô∏è‚É£ Incident Management & Root Cause</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí Data Owner/Steward valide si c'est VRAIMENT une erreur</div>
                <div style="margin-left: 40px; margin-bottom: 10px;">‚Üí Root cause analysis: code error? Source data changed? Schema evolution? R√®gle m√©tier chang√©e?</div>
                <div style="margin-left: 40px;">‚Üí Fix (code dbt, source data, ou r√®gle m√©tier) + prevent future occurrences</div>
            </div>

            <h3 style="margin-top: 20px; color: #333;">Processus de D√©veloppement avec dbt Cloud</h3>
            <div class="stage-box">
                <h4>üìù D√©veloppement & Test G√©n√©ration (Copilot)</h4>
                <ul class="tools-list">
                    <li><strong>Copilot IA:</strong> G√©n√®re 80% des tests automatiquement, 20% √† affiner (tuning m√©tier)</li>
                    <li><strong>Pas d'installation locale:</strong> D√©velopper directement sur dbt Cloud web interface (Git int√©gr√©)</li>
                    <li><strong>Branching facile:</strong> Pas de terminal, cr√©er branches visuellement sans commandes</li>
                    <li><strong>Extension VS Code:</strong> Pour les users tech (CLI + git avanc√©)</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4>‚úÖ CI/CD & Validation Automatique</h4>
                <ul class="tools-list">
                    <li><strong>dbt Cloud Job:</strong> Ex√©cute tous les tests modifi√©s + models affect√©s en PR</li>
                    <li><strong>Bloquer les merges dangereuses:</strong> Pas de merge si tests fail</li>
                    <li><strong>Intelligent Execution:</strong> Reuse test results si code/data n'a pas chang√© (optimisation)</li>
                    <li><strong>Visualiser l'impact:</strong> Voir quels dashboards/rapports seront affect√©s</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4>üìä Monitoring & Alerting Continu</h4>
                <ul class="tools-list">
                    <li><strong>Tests s'ex√©cutent en schedule:</strong> Ex: chaque nuit apr√®s refresh source</li>
                    <li><strong>Multi-channel alerting:</strong> Slack, Email, Dashboard m√©tier (Power BI/Tableau)</li>
                    <li><strong>Data Freshness Badge:</strong> Montrer sur les dashboards BI si data est fra√Æche</li>
                    <li><strong>Quality Scoring:</strong> Niveau Warning vs Error (probabilit√© vs gravit√©)</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4>üîó Int√©gration BI Transparente</h4>
                <ul class="tools-list">
                    <li><strong>Connexion directe Tableau/Power BI:</strong> Plug-and-play natif aux mod√®les dbt</li>
                    <li><strong>Badge de qualit√© sur les champs:</strong> Voir test status + data freshness directement en BI</li>
                    <li><strong>Cliquer test ‚Üí aller √† dbt Cloud:</strong> Root cause analysis one-click</li>
                    <li><strong>Lineage visuel:</strong> Montrer exactement o√π le probl√®me s'est introduit (source ‚Üí transformation ‚Üí BI)</li>
                </ul>
            </div>

            <div class="stage-box">
                <h4>üì¶ Semantic Layer pour D√©finitions Business</h4>
                <ul class="tools-list">
                    <li><strong>Centraliser d√©finitions:</strong> Revenue, Customer, Order = m√™mes d√©finitions partout</li>
                    <li><strong>√âviter les incoh√©rences:</strong> Les m√©tiers utilisent la m√™me "langue"</li>
                    <li><strong>M√©tier-friendly:</strong> Acc√®s via Power BI sans SQL</li>
                </ul>
            </div>

            <div class="section-title">Architecture M√©daillon & Testing Strategy</div>
            <p><strong>Codex utilise l'architecture Bronze ‚Üí Silver ‚Üí Gold</strong></p>
            <p style="margin-top: 10px;"><strong>üî¥ BRONZE (Raw/Landing):</strong> Donn√©es brutes des sources</p>
            <ul style="margin-left: 40px; margin-top: 5px;">
                <li>Tests: Source freshness, row count validation, schema checks</li>
                <li>Objectif: Assurer que les donn√©es arrivent √† temps et compl√®tes</li>
            </ul>

            <p style="margin-top: 15px;"><strong>üü° SILVER (Staging/Transformation):</strong> Donn√©es nettoy√©es et enrichies</p>
            <ul style="margin-left: 40px; margin-top: 5px;">
                <li>Tests: Data integrity (no nulls cl√©s), deduplication, data type checks</li>
                <li>Tests: Relationships entre tables, accepted_values</li>
                <li>Objectif: Valider transformations, pr√©venir fan-outs/joins manqu√©s</li>
            </ul>

            <p style="margin-top: 15px;"><strong>üü¢ GOLD (Mart/Analytics):</strong> Mod√®les finaux pour BI</p>
            <ul style="margin-left: 40px; margin-top: 5px;">
                <li>Tests: R√®gles m√©tier complexes (calculs, agr√©gations, validations)</li>
                <li>Tests: Coh√©rence avec d√©finitions m√©tier (revenue, customer, etc.)</li>
                <li>Objectif: Assurer confiance pour d√©cisions business</li>
            </ul>

            <h3 style="margin-top: 20px; color: #333;">Couches de Tests dans Codex</h3>
            <div class="grid-2">
                <div class="stage-box">
                    <h4>üî¥ Raw/Landing (Bronze)</h4>
                    <p>Tests sur source freshness, basic profiling</p>
                </div>
                <div class="stage-box">
                    <h4>üü° Staging (Silver)</h4>
                    <p>Tests d'int√©grit√© donn√©es, transformations basiques</p>
                </div>
                <div class="stage-box">
                    <h4>üü¢ Mart Models (Gold)</h4>
                    <p>Tests de r√®gles m√©tier, relationships, accept√©_values</p>
                </div>
                <div class="stage-box">
                    <h4>üìä BI Layer (Power BI)</h4>
                    <p>Metrics consistency (via dbt Semantic Layer)</p>
                </div>
            </div>
        </div>

        <!-- TAB 5: GOVERNANCE -->
        <div id="governance" class="tab-content">
            <h2 class="section-title">Gouvernance & Organisation</h2>

            <div class="stage-box">
                <h3><span class="stage-icon">1</span> Qui D√©finit Quoi?</h3>
                <p><strong>Chapters (Guilds):</strong></p>
                <ul class="tools-list">
                    <li>Regroupe tous les Data Engineers / Data Architects des diff√©rentes squads</li>
                    <li>R√©unions hebdos pour discuter guidelines, bonnes pratiques</li>
                    <li>Proposent des standards √† appliquer de mani√®re top-down</li>
                </ul>
                <p style="margin-top: 15px;"><strong>Data Governance Team:</strong></p>
                <ul class="tools-list">
                    <li>Travaille avec data owners pour D√âFINIR les r√®gles m√©tier</li>
                    <li>Valide les r√®gles de qualit√© propos√©es par squads</li>
                    <li>Propri√©taires de la harmonisation des d√©finitions (s√©mantique)</li>
                </ul>
                <p style="margin-top: 15px;"><strong>Data Engineers (par squad):</strong></p>
                <ul class="tools-list">
                    <li>Impl√©mentent les r√®gles en tant que tests dbt</li>
                    <li>Ex√©cutent et monitorer les tests</li>
                </ul>
            </div>

            <div class="stage-box">
                <h3><span class="stage-icon">2</span> Approche Recommand√©e: Commencer par un Pilot</h3>
                <p><strong>Pourquoi?</strong> √âviter de se perdre dans la complexit√© org/admin.</p>
                <p><strong>Pilot Scope:</strong></p>
                <ul class="tools-list">
                    <li>Choisir 1-2 data products pilot (ex: CRM, Supply Chain)</li>
                    <li>Impl√©menter le full workflow quality avec dbt</li>
                    <li>Montrer ROI, bonnes pratiques, quick wins</li>
                    <li>Ensuite sist√©matiser et scaler aux autres squads</li>
                </ul>
            </div>

            <div class="benefit-box">
                <strong>‚úÖ Avantage:</strong> Les chapters peuvent d√©finir les guidelines (bonnes pratiques, architecture), mais les r√®gles m√©tier sp√©cifiques viennent des data product owners + gouvernance. Chaque squad reste agile sur son produit tout en respectant les standards.
            </div>

            <h3 style="margin-top: 30px; color: #333;">R√¥les Cl√©s</h3>
            <div class="stakeholder-card">
                <strong>Laurent Girardeau (Data Quality Project Owner)</strong>
                Data Quality Project Owner depuis 8 mois - Trouver solutions, piloter impl√©mentation, assurer l'adoption
            </div>
            <div class="stakeholder-card">
                <strong>Data Stewards / Product Owners</strong>
                Identifier r√®gles m√©tier, valider qualit√©, alerter m√©tier en cas d'incident
            </div>
            <div class="stakeholder-card">
                <strong>Data Engineers</strong>
                Impl√©menter & ex√©cuter tests, fixer bugs data
            </div>
            <div class="stakeholder-card">
                <strong>M√©tier / BI Users</strong>
                Recevoir alerts, agir si donn√©es impact√©es, feedback sur quality
            </div>
        </div>

        <!-- TAB 6: IMPLEMENTATION -->
        <div id="implementation" class="tab-content">
            <h2 class="section-title">Roadmap Impl√©mentation</h2>

            <h3 style="margin-top: 20px; color: #333;">Phase 1: Fondations (Mois 1-2)</h3>
            <div class="stage-box">
                <p>‚úì D√©finir taxonomy de donn√©es quality (le "DOG" - Distinctiveness, Ownership, Governance)</p>
                <p>‚úì Standardiser format tests dbt (YAML structure, naming conventions)</p>
                <p>‚úì Cr√©er templates dbt pour profiling, monitoring, alerting</p>
                <p>‚úì S√©lectionner 1-2 data products PILOT</p>
                <p>‚úì Training √©quipes sur dbt testing + data quality concepts</p>
            </div>

            <h3 style="margin-top: 20px; color: #333;">Phase 2: Pilot Implementation (Mois 2-4)</h3>
            <div class="stage-box">
                <p>‚úì Impl√©menter tests complets sur pilot data products</p>
                <p>‚úì Definir r√®gles de qualit√© m√©tier (avec data stewards + governance)</p>
                <p>‚úì Setup monitoring & alerting infrastructure (Slack, emails)</p>
                <p>‚úì Documenter models et data dans dbt Catalog</p>
                <p>‚úì Tester Copilot (if dbt Enterprise) pour test generation</p>
            </div>

            <h3 style="margin-top: 20px; color: #333;">Phase 3: Chapters Guidelines (Mois 3-5)</h3>
            <div class="stage-box">
                <p>‚úì Capitaliser sur learnings du pilot</p>
                <p>‚úì Chapters d√©finissent DQ guidelines standards</p>
                <p>‚úì Cr√©er reusable test macros + packages</p>
                <p>‚úì D√©finir quality SLAs par type de donn√©e</p>
                <p>‚úì Training wider squad membership</p>
            </div>

            <h3 style="margin-top: 20px; color: #333;">Phase 4: Scale-out (Mois 5+)</h3>
            <div class="stage-box">
                <p>‚úì Rollout √† toutes les squads/domaines</p>
                <p>‚úì Int√©grer QA testing dans CI/CD pipelines</p>
                <p>‚úì Dashboard de data quality (show test health, SLA compliance)</p>
                <p>‚úì Feedback loops: m√©tier ‚Üí governance ‚Üí data engineers</p>
                <p>‚úì Optimiser & refine processes based on usage</p>
            </div>

            <h3 style="margin-top: 30px; color: #333;">Succ√®s Metrics</h3>
            <div class="grid-2">
                <div class="stage-box">
                    <p><strong>Technique:</strong></p>
                    <ul class="tools-list">
                        <li>100% des mod√®les golden ont des tests</li>
                        <li>Test coverage > 80%</li>
                        <li>MTTR (mean time to recovery) < 1 heure</li>
                        <li>Zero data quality incidents reaching BI users</li>
                    </ul>
                </div>
                <div class="stage-box">
                    <p><strong>Business:</strong></p>
                    <ul class="tools-list">
                        <li>Adoption: % of squads using dbt tests</li>
                        <li>Trust: Data quality feedback from m√©tier</li>
                        <li>Velocity: Faster deployments (tests prevent regressions)</li>
                        <li>Harmonization: Common quality standards across org</li>
                    </ul>
                </div>
            </div>

            <h3 style="margin-top: 30px; color: #333;">Ressources Suppl√©mentaires dbt</h3>
            <p><strong>Documentation & Learning:</strong></p>
            <ul class="tools-list">
                <li>dbt docs: <a href="https://docs.getdbt.com" target="_blank">docs.getdbt.com</a> - Data Testing section</li>
                <li>dbt Learn: Free courses on dbt testing best practices</li>
                <li>dbt packages: dbt_expectations, great_expectations integration</li>
                <li>dbt Copilot: Available for Enterprise+ (AI-assisted test generation)</li>
            </ul>

            <div class="benefit-box" style="margin-top: 20px;">
                <strong>üí° Consid√©ration:</strong> dbt Cloud Enterprise offre des features avanc√©es (Copilot, Extended documentation, advanced scheduler, etc.). Pour Pernod Ricard √† l'√©chelle, √ßa vaudrait le coup d'explorer.
            </div>
        </div>
    </div>

    <script>
        function switchTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
